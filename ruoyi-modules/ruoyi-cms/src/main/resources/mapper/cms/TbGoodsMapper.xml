<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.cms.mapper.TbGoodsMapper">

    <insert id="saveGoods" parameterType="com.ruoyi.cms.domain.TbGoods" useGeneratedKeys="true" keyProperty="id">
        insert into tb_goods set
            goods_name=#{goodsName},
            audit_status=1,
            brand_id=#{brandId},
            caption=#{caption},
            category1_id=#{category1Id},
            category2_id=#{category2Id},
            category3_id=#{category3Id},
            price=#{price},
            type_template_id=#{typeTemplateId}
    </insert>

    <insert id="saveGoodsDesc" parameterType="com.ruoyi.cms.domain.TbGoodsDesc">
        insert into tb_goods_desc set 
            goods_id=#{goodsId},
            introduction=#{introduction},
            specification_items=#{specificationItems},
            custom_attribute_items=#{customAttributeItems},
            item_images=#{itemImages},
            package_list=#{packageList},
            sale_service=#{saleService}
    </insert>

    <insert id="saveItems" parameterType="com.ruoyi.cms.domain.TbItem">
        insert into tb_item(title,price,num,image,categoryId,status,create_time,update_time,goods_id,seller_id,category,brand,spec,seller) values
        <foreach collection="list" item="item" separator=",">
            (#{item.title},#{item.price},#{item.num},#{item.image},#{item.categoryId},#{item.status},now(),now(),#{item.goodsId},#{item.sellerId},#{item.category},#{item.brand},#{item.spec},#{item.seller})
        </foreach>
    </insert>

    <select id="listAllItem" resultType="map">
        select * from tb_item;
    </select>

    <select id="listByTime" resultType="map" parameterType="date">
        select * from tb_item where update_time>=#{date};
    </select>
</mapper>